<form ng-submit="vm.save()" novalidate>
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">
            New Quote
          </h5>
          <p class="warning-tooltip">
            {{ vm.contract.year }} {{ vm.contract.make }} {{ vm.contract.model }} <br />
            {{ vm.contract.vin }}
          </p>
          <div class="py-3">
            <div>
              <div class="form-group">
                <label class="control-label">Dealership</label>
                <select class="form-control" ng-options="dealership as dealership.name for dealership in vm.dealerships track by dealership.id" ng-model="vm.contract.dealership"></select>
              </div>

              <hr />
            </div>

            <div class="row">
              <div class="col-4">
                <div ng-class="{ 'is-invalid': vm.contract.errors.vin }" class="form-group">
                  <label class="control-label">VIN</label>
                  <input class="form-control" ng-model="vm.contract.vin" ng-change="vm.checkVIN()" />
                </div>

                <div class="form-group">
                  <label>Purchase Date</label>
                  <input class="form-control" type="date" ng-model="vm.contract.purchased_on" />
                </div>

                <div class="form-group">
                  <label>Miles</label>
                  <input class="form-control" ng-model="vm.contract.odometer" />
                </div>

                <hr />

                <div class="form-group">
                  <label>Name</label>
                  <div class="row">
                    <div class="col pr-1">
                      <input class="form-control" ng-model="vm.contract.first_name" placeholder="First" />
                    </div>
                    <div class="col pl-1">
                      <input class="form-control" ng-model="vm.contract.last_name" placeholder="Last" />
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label>Address</label>
                  <ul>
                    <li>{{ vm.contract.address1 }}</li>
                    <li>{{ vm.contract.address2 }}</li>
                    <li>{{ vm.contract.address3 }}</li>
                    <li>{{ vm.contract.city }}, {{ vm.contract.state }} {{ vm.contract.zip }}</li>
                  </ul>
                </div>
              </div>
              <div class="col-8">
                <div ng-repeat="package in vm.template.packages" class="package">
                  <span class="float-left">{{ package.name }}</span>
                  <div class="coverage-and-addons">
                    <label ng-repeat="coverage in package.coverages">
                      <input type="radio" name="coverage" ng-change="vm.uncheckAddons()" ng-model="vm.contract.coverage" ng-value="coverage" ng-checked="vm.contract.coverage.id === coverage.id" /> {{ coverage.limit_in_miles | number }}
                    </label>
                    <br />
                    <label ng-repeat="addon in package.addons" ng-class="{ 'text-secondary': !vm.packageSelected(package) }">
                      <input ng-disabled="!vm.packageSelected(package)" type="checkbox" ng-name="package_{{ package.id }}_addon_{{ addon.id }}" checklist-model="vm.contract.addons" checklist-value="addon.id" /> {{ addon.name }} <span ng-if="addon.amount_in_cents">- {{ (addon.amount_in_cents / 100) | currency }}</span>
                    </label>
                  </div>
                  <div class="clearfix"></div>
                  <hr />
                </div>
              </div>
            </div>

            <hr />

            <div class="form-group">
              <div class="float-right">
                <button type="submit" class="btn btn-primary">Save</button>
                <button type="button" ng-click="vm.cancel()" class="btn btn-link">Cancel</button>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</form>
